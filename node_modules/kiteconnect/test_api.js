var KiteConnect = require('./lib').KiteConnect;

var apiKey = 'gvu4pixmenhmg9im'
var apiSecret = 'y1c83uskv1rvum5ui47dcjqnzcpqs37v'
// var apiKey = 'gvu4pixmenhmg9im'
// var apiSecret = 'qkfr1xg1gip2smdwafytppugvkhy8czj'
var requestToken = 'a9AQ8mr5EnxtfnjXCCZhGOuCkFkFz2SK'
var accessToken = 'HTOIWD7o13n0YqmFU6mbB7j968Regdxj'

var k = new KiteConnect({
	api_key: apiKey
})

if (accessToken) {
	k.setAccessToken(accessToken)
	init()
} else {
	k.generateSession(requestToken, apiSecret).then(function (resp) {
		console.log(resp)
		k.setAccessToken(resp.access_token)
		init()
	}).catch(function (error) {
		console.log("error", error)
		// console.log(error)
	})
}

function init() {
	console.log('init')
	// k.getGTTs().then(function (resp) {
	// 	console.log(resp)
	// }).catch(function (error) {
	// 	console.log(error)
	// })

	k.getGTT(465823).then(function (resp) {
		console.log(resp)
	}).catch(function (error) {
		console.log(error)
	})

	// k.placeGTT({
	// 	trigger_type: k.GTT_TYPE_OCO,
	// 	tradingsymbol: "SBIN",
	// 	exchange: "NSE",
	// 	trigger_values: [300, 400],
	// 	last_price: 318,
	// 	orders: [{
	// 		transaction_type: k.TRANSACTION_TYPE_SELL,
	// 		quantity: 1,
	// 		product: k.PRODUCT_CNC,
	// 		order_type: k.ORDER_TYPE_LIMIT,
	// 		price: 300
	// 	}, {
	// 		transaction_type: k.TRANSACTION_TYPE_SELL,
	// 		quantity: 1,
	// 		product: k.PRODUCT_CNC,
	// 		order_type: k.ORDER_TYPE_LIMIT,
	// 		price: 400
	// 	}]
	// }).then(function (resp) {
	// 	console.log(resp)
	// }).catch(function (error) {
	// 	console.log(error)
	// })

	// k.modifyGTT(465823, {
	// 	trigger_type: k.GTT_TYPE_OCO,
	// 	tradingsymbol: "SBIN",
	// 	exchange: "NSE",
	// 	trigger_values: [301, 401],
	// 	last_price: 318,
	// 	orders: [{
	// 		transaction_type: k.TRANSACTION_TYPE_SELL,
	// 		quantity: 1,
	// 		product: k.PRODUCT_CNC,
	// 		order_type: k.ORDER_TYPE_LIMIT,
	// 		price: 300
	// 	}, {
	// 		transaction_type: k.TRANSACTION_TYPE_SELL,
	// 		quantity: 1,
	// 		product: k.PRODUCT_CNC,
	// 		order_type: k.ORDER_TYPE_LIMIT,
	// 		price: 400
	// 	}]
	// }).then(function (resp) {
	// 	console.log(resp)
	// }).catch(function (error) {
	// 	console.log(error)
	// })

	// k.deleteGTT(465823).then(function (resp) {
	// 	console.log(resp)
	// }).catch(function (error) {
	// 	console.log(error)
	// })
}
